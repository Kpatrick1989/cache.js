!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Cache=t()}(this,function(){"use strict";var c={debug:!1,storage:"localStorage"},e={};function o(e,t,r){var c,o,a=(c=t,o=parseFloat(c),isNaN(o)?c:o);switch(i(e)){case"y":r.setFullYear(r.getFullYear()+a);break;case"M":r.setMonth(r.getMonth()+a);break;case"w":r.setDate(r.getDate()+7*a);break;case"d":r.setDate(r.getDate()+a);break;case"h":r.setHours(r.getHours()+a);break;case"m":r.setMinutes(r.getMinutes()+a);break;case"s":r.setSeconds(r.getSeconds()+a);break;default:r.setDate(r.getDate()+a)}return r}function a(e,t,r){if(c.debug)switch(e){case"set":console.log("%c cache:%cSET "+t+" %c"+r,"color:green","color:green;font-weight:bold","");break;case"get":console.log("%c cache:%cGET "+t+" %c"+r,"color:blue","color:blue;font-weight:bold","");break;case"remove":console.log("%c cache:%cREMOVE "+t+" %c"+r,"color:#93135F","color:#93135F;font-weight:bold","");break;case"clear":console.log("%c cache:%cCLEAR "+t+" %c"+r,"color:#56CB96","color:#56CB96;font-weight:bold","");break;case"update":console.log("%c cache:%cUPDATE "+t+" %c"+r,"color:#199DCE","color:#199DCE;font-weight:bold","")}}e.debug={enable:function(){c.debug=!0},disabled:function(){c.debug=!1},state:function(){return c.debug}},e.set=function(){if(!this.canIUse)return!1;var e=arguments;try{switch(e.length){case 2:var t=JSON.parse(this.storage.getItem(i(e[0])));t&&""!=t.Expires?this.storage.setItem(i(e[0]),i({Content:e[1],Expires:t.Expires})):this.storage.setItem(i(e[0]),i({Content:e[1],Expires:""}));var r=""==(t=JSON.parse(this.storage.getItem(i(e[0])))).Expires?"":new Date(t.Expires);a("set","success",i(e[0])+":"+i(e[1])+"  "+r);break;case 3:n(e[2])&&s(e[2],"type")&&s(e[2],"delay")?(this.storage.setItem(i(e[0]),i({Content:e[1],Expires:o(e[2].type,e[2].delay,new Date)})),a("set","success",i(e[0])+":"+i(e[1])+"  "+o(e[2].type,e[2].delay,new Date))):console.error('%c cache:%cSET error %c过期时间设置格式必须是%c {"type":时间类型<String>,"delay":延迟时间<Number>} %c！',"","font-weight:bold","","font-style: italic","");break;default:console.error("%c cache:%cSET error %c参数应为%c (键<String>, 值<Any>, [过期时间<Obj>]) %c！","","font-weight:bold","","font-style: italic","")}}catch(e){}},e.get=function(){if(!this.canIUse)return!1;var e=arguments;try{var t=JSON.parse(this.storage.getItem(i(e[0])));if(!t)return void a("get","error",i(e[0])+" 此 Key 不存在！");var r=""==t.Expires?"":new Date(t.Expires);return""!==t.Expires&&new Date(t.Expires)<new Date?(this.storage.removeItem(i(e[0])),void a("get","success",i(e[0])+" 过期已清除！")):(a("get","success",i(e[0])+":"+i(t.Content)+"  "+r),t.Content)}catch(e){}},e.remove=function(){if(!this.canIUse)return!1;var e=arguments;try{var t=JSON.parse(this.storage.getItem(i(e[0])));if(!t)return void a("remove","error",i(e[0])+" 此 Key 不存在！");var r=""==t.Expires?"":new Date(t.Expires);a("remove","success",i(e[0])+":"+i(t.Content)+"  "+r),this.storage.removeItem(i(e[0]))}catch(e){}},e.clear=function(){if(!this.canIUse)return!1;try{this.storage.clear(),a("clear","success","已清除全部数据！")}catch(e){}},e.update=function(){if(!this.canIUse)return!1;var e=arguments,t=JSON.parse(this.storage.getItem(i(e[0])));if(t)try{switch(e.length){case 2:n(e[1])&&s(e[1],"type")&&s(e[1],"delay")?(this.storage.setItem(i(e[0]),i({Content:t.Content,Expires:o(e[1].type,e[1].delay,new Date)})),a("update","success",i(e[0])+":"+i(t.Content)+"  "+o(e[1].type,e[1].delay,new Date))):console.error('%c cache:%cUPDATE error %c过期时间设置格式必须是%c {"type":时间类型<String>,"delay":延迟时间<Number>} %c！',"","font-weight:bold","","font-style: italic","");break;case 3:n(e[2])&&s(e[2],"type")&&s(e[2],"delay")?(this.storage.setItem(i(e[0]),i({Content:e[1],Expires:o(e[2].type,e[2].delay,new Date)})),a("update","success",i(e[0])+":"+i(e[1])+"  "+o(e[2].type,e[2].delay,new Date))):console.error('%c cache:%cUPDATE error %c过期时间设置格式必须是%c {"type":时间类型<String>,"delay":延迟时间<Number>} %c！',"","font-weight:bold","","font-style: italic","");break;default:console.error("%c cache:%cUPDATE error %c参数应为%c (键<String>, [值<Any>], 过期时间<Obj>) %c！","","font-weight:bold","","font-style: italic","")}}catch(e){}else a("update","error",i(e[0])+" 此 Key 不存在！")};var r=Object.prototype.hasOwnProperty;function s(e,t){return r.call(e,t)}function n(e){return null!==e&&"object"==typeof e}function i(e){return null==e?"":"object"==typeof e?JSON.stringify(e):String(e)}function t(){var e=arguments;switch(e.length){case 0:break;case 1:"localStorage"==e[0]||"sessionStorage"==e[0]?c.storage=e[0]:console.warn('cache:%cWARN %c配置参数必须是"localStorage"或"sessionStorage"！',"font-weight:bold","");break;default:console.warn("cache:%cWARN %c配置参数必须是字符串！","font-weight:bold","")}var t=function(e){try{return"string"==typeof e&&window[e]instanceof Storage?window[e]:e}catch(e){}}(c.storage),r=function(e){var t=!1;if(e&&e.setItem){t=!0;var r="_"+Math.round(1e7*Math.random());try{e.setItem(r,r),e.removeItem(r)}catch(e){t=!1}}return t}(t);this.canIUse=function(){return r},this.storage=t}return t.prototype=e,t});